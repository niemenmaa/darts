import{g as W,s as q,a as h,b as H,c as S,d as V,e as X,I as k,f as Y,r as j}from"./board-CNtetGwf.js";let s={noOuts:[169,168,166,165,163,162,159],max:170,min:2,mentalMathMode:!1,ringAccuracy:100,sectorAccuracy:100};function F(){const t=W();t&&(s.min=t.min??2,s.max=t.max??170,s.mentalMathMode=t.mentalMathMode??!1,s.ringAccuracy=t.ringAccuracy??100,s.sectorAccuracy=t.sectorAccuracy??100)}function P(){q({min:s.min,max:s.max,mentalMathMode:s.mentalMathMode,ringAccuracy:s.ringAccuracy,sectorAccuracy:s.sectorAccuracy})}function z(t){t.min!==void 0&&(s.min=Math.max(2,Math.min(170,t.min))),t.max!==void 0&&(s.max=Math.max(2,Math.min(170,t.max))),t.mentalMathMode!==void 0&&(s.mentalMathMode=t.mentalMathMode),t.ringAccuracy!==void 0&&(s.ringAccuracy=Math.max(0,Math.min(100,t.ringAccuracy))),t.sectorAccuracy!==void 0&&(s.sectorAccuracy=Math.max(0,Math.min(100,t.sectorAccuracy))),s.min>s.max&&([s.min,s.max]=[s.max,s.min]),P()}F();let M=0,$=0,b=3,v=null,A=[],B=null,C=0,L=null,I=[];function U(t){if(!t)return null;const a={...t};let e={...t},r=!1,l=null;const c=t.text.startsWith("T"),m=t.text.startsWith("D")||t.value===50,i=t.value===25||t.value===50,d=t.value===50,y=t.value===25;let o;if(i?o=t.value:c||m?o=parseInt(t.text.substring(1)):o=t.value,i){if(d){if(s.sectorAccuracy<100&&Math.random()*100>=s.sectorAccuracy){const n=h[Math.floor(Math.random()*h.length)];return e.text=String(n),e.value=n,r=!0,l="sector",{original:a,actual:e,wasMiss:r,missType:l}}s.ringAccuracy<100&&Math.random()*100>=s.ringAccuracy&&(e.text="25",e.value=25,r=!0,l="ring")}else if(y&&s.sectorAccuracy<100&&Math.random()*100>=s.sectorAccuracy)if(r=!0,l="sector",Math.random()<.15)e.text="50",e.value=50;else{const n=h[Math.floor(Math.random()*h.length)];e.text=String(n),e.value=n}return{original:a,actual:e,wasMiss:r,missType:l}}if(s.sectorAccuracy<100&&Math.random()*100>=s.sectorAccuracy){const n=h.indexOf(o),f=Math.random()<.5?(n-1+h.length)%h.length:(n+1)%h.length;o=h[f],r=!0,l="sector"}return(c||m)&&s.ringAccuracy<100?Math.random()*100>=s.ringAccuracy?(e.text=String(o),e.value=o,r=!0,l=l?"both":"ring"):c?(e.text=`T${o}`,e.value=o*3):(e.text=`D${o}`,e.value=o*2):!c&&!m?(e.text=String(o),e.value=o):c?(e.text=`T${o}`,e.value=o*3):(e.text=`D${o}`,e.value=o*2),{original:a,actual:e,wasMiss:r,missType:l}}function Z(t,a){const e=document.getElementById("board");if(!e)return;const r=t==="25"||t==="50",l=e.querySelectorAll("[data-score]");let c=null;if(r)c=e.querySelector('[data-score="50"]');else{const i=parseInt(String(t).replace(/[TD]/g,""));for(const d of l)if(parseInt(d.dataset.score)===i&&d.dataset.score!=="50"){c=d;break}}if(!c)return;const m=document.createElement("div");if(m.className=`dart-marker absolute w-3 h-3 rounded-full z-30 pointer-events-none ${a?"bg-yellow-400":"bg-white"} border-2 ${a?"border-yellow-600":"border-slate-600"}`,r){const i=I.length-1,y=[{x:0,y:0},{x:-6,y:4},{x:6,y:4}][i]||{x:0,y:0};m.style.cssText=`top: 50%; left: 50%; transform: translate(calc(-50% + ${y.x}px), calc(-50% + ${y.y}px));`}else{const i=h.indexOf(parseInt(c.dataset.score)),d=360/h.length,y=(i*d-90)*Math.PI/180,o=38+I.length*3,x=50+o*Math.cos(y),n=50+o*Math.sin(y);m.style.cssText=`top: ${n}%; left: ${x}%; transform: translate(-50%, -50%);`}e.appendChild(m)}function _(){const t=document.getElementById("board");t&&t.querySelectorAll(".dart-marker").forEach(a=>a.remove())}function G(){N(),B=Date.now(),w(),L=setInterval(w,1e3)}function N(){L&&(clearInterval(L),L=null)}function w(){const t=document.getElementById("timer-display");if(t&&B){const a=Math.floor((Date.now()-B)/1e3);t.textContent=`${a}s`}}function E(){let t;do t=Math.floor(Math.random()*(s.max-s.min+1))+s.min;while(s.noOuts.includes(t));return M=t,$=t,b=3,v=null,C=0,I=[],_(),G(),R(),t}function R(){const t=document.getElementById("target-display"),a=document.getElementById("darts-display"),e=document.getElementById("game-status"),r=document.getElementById("history-display"),l=document.getElementById("throws-display");if(t&&(s.mentalMathMode?t.textContent=$:t.textContent=M),a){const c=3-b;let m="";for(let i=0;i<3;i++){const d=i<c?"opacity-30":"";m+=`<span class="${d}">ðŸŽ¯</span>`}a.innerHTML=m}l&&(l.textContent=I.map(c=>c.text).join(" | ")),e&&(v==="win"?(e.textContent="WIN!",e.className="text-3xl font-bold mt-2 h-10 text-green-400"):v==="lose"?(e.textContent="LOSE",e.className="text-3xl font-bold mt-2 h-10 text-red-400"):(e.textContent="",e.className="text-3xl font-bold mt-2 h-10")),r&&(r.innerHTML=A.map(c=>`<div class="flex justify-between items-center px-2 py-1 ${c.result==="W"?"text-green-400":"text-red-400"}">
                <span class="font-bold">${c.result==="W"?"âœ“":"âœ—"}</span>
                <span>${c.target}</span>
                <span>${c.throws}ðŸŽ¯</span>
                <span>${c.time}s</span>
            </div>`).join(""))}function J(t,a){const e=document.getElementById("miss-notification");e&&(e.textContent=`Missed! ${t.text} â†’ ${a.text}`,e.style.opacity="1",setTimeout(()=>{e.style.opacity="0"},2e3))}function T(t){if(!t)return;const a=U(t);if(!a)return;const{original:e,actual:r,wasMiss:l}=a,{text:c,value:m}=r,i=c.startsWith("D")||m===50;l&&J(e,r),I.push(r),Z(r.text,l),v!==null&&(v=null),C++,M-=m,b--;const d=y=>{N();const o=Math.round((Date.now()-B)/1e3);A.unshift({result:y,time:o,throws:C,target:$}),A.length>10&&A.pop()};return M===0?(i?(v="win",d("W")):(v="lose",d("L")),setTimeout(()=>{E()},1500)):M<0?(v="lose",d("L"),setTimeout(()=>{E()},1500)):b===0&&(v="lose",d("L"),setTimeout(()=>{E()},1500)),R(),{text:c,value:m,isDouble:i}}document.addEventListener("DOMContentLoaded",()=>{console.log("ðŸŽ¯ Darts app initialized"),K()});function K(){const t=H();document.getElementById("board-container").appendChild(t),et(),Q(),tt(),E()}function Q(){const t=document.getElementById("menu-btn"),a=document.getElementById("menu-dropdown");t.addEventListener("click",e=>{e.stopPropagation(),a.classList.toggle("hidden")}),document.addEventListener("click",e=>{!a.contains(e.target)&&e.target!==t&&a.classList.add("hidden")})}function tt(){const t=document.getElementById("settings-btn"),a=document.getElementById("settings-modal"),e=document.getElementById("settings-close"),r=document.getElementById("settings-save"),l=document.getElementById("settings-min"),c=document.getElementById("settings-max"),m=document.getElementById("settings-mental-math"),i=document.getElementById("settings-ring-accuracy"),d=document.getElementById("settings-sector-accuracy"),y=document.getElementById("ring-accuracy-value"),o=document.getElementById("sector-accuracy-value");function x(){l.value=s.min,c.value=s.max,n(s.mentalMathMode),i.value=s.ringAccuracy,d.value=s.sectorAccuracy,y.textContent=`${s.ringAccuracy}%`,o.textContent=`${s.sectorAccuracy}%`}function n(f){const g=m,p=g.querySelector("span");f?(g.classList.remove("bg-slate-600"),g.classList.add("bg-emerald-500"),p.classList.add("translate-x-5")):(g.classList.add("bg-slate-600"),g.classList.remove("bg-emerald-500"),p.classList.remove("translate-x-5")),g.dataset.enabled=f}i.addEventListener("input",()=>{y.textContent=`${i.value}%`}),d.addEventListener("input",()=>{o.textContent=`${d.value}%`}),t.addEventListener("click",()=>{document.getElementById("menu-dropdown").classList.add("hidden"),x(),a.classList.remove("hidden"),a.classList.add("flex")});function u(){a.classList.add("hidden"),a.classList.remove("flex")}e.addEventListener("click",u),a.addEventListener("click",f=>{f.target===a&&u()}),m.addEventListener("click",()=>{const f=m.dataset.enabled==="true";n(!f)}),r.addEventListener("click",()=>{const f=parseInt(l.value)||2,g=parseInt(c.value)||170,p=m.dataset.enabled==="true",D=parseInt(i.value)||100,O=parseInt(d.value)||100;z({min:f,max:g,mentalMathMode:p,ringAccuracy:D,sectorAccuracy:O}),u(),E()})}function et(){const t=document.getElementById("board");let a=!1,e=null,r=null,l=!1,c=!1;function m(){const n=t.getBoundingClientRect();return{x:n.left+n.width/2,y:n.top+n.height/2}}function i(n,u){const f=m(),g=n-f.x,p=u-f.y;return Math.sqrt(g*g+p*p)}function d(n,u,f){a=!0,l=!1,e=i(n,u),r=null;const g=f.target.closest("[data-score]"),p=g&&g.dataset.score==="50",D=S(f);c=p||D>=k}function y(n,u,f){if(!a||!c)return;const g=i(n,u);!r&&Math.abs(g-e)>5&&(r=g>e?"out":"in",l=!0),r==="out"?V(f):r==="in"&&X(f)}function o(n){if(r){const u=Y();u&&T(u)}a=!1,e=null,r=null,c=!1,j()}function x(n){if(l){l=!1;return}const u=n.target.closest("[data-score]");if(u){if(u.dataset.score==="50")T({text:"50",value:50});else if(S(n)>=k){const g=parseInt(u.dataset.score);T({text:String(g),value:g})}}}t.addEventListener("mousedown",n=>d(n.clientX,n.clientY,n)),t.addEventListener("mousemove",n=>y(n.clientX,n.clientY,n)),t.addEventListener("mouseup",n=>o()),t.addEventListener("mouseleave",n=>o()),t.addEventListener("click",x),t.addEventListener("touchstart",n=>{const u=n.touches[0];d(u.clientX,u.clientY,n)},{passive:!0}),t.addEventListener("touchmove",n=>{const u=n.touches[0];y(u.clientX,u.clientY,n)},{passive:!0}),t.addEventListener("touchend",n=>o()),t.addEventListener("touchcancel",n=>o())}
